module main

import std.containers as containers;
import std.iter as iter;
use trait iter.SinglePassIterator;

fn run() -> Int {
	var s = containers.hash_set<type Int>();
	s.insert(1);
	s.insert(2);
	s.insert(3);
	var it = s.iter();
	s.insert(4);
	var invalidated = false;
	try {
		val _x = it.next();
	} catch {
		invalidated = true;
	}
	if not invalidated { return 1; }
	return 0;
}

fn main() nothrow -> Int {
	return try run() catch { 99 };
}
