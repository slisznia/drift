module main

import std.containers as containers;

fn run() -> Int {
	var m = containers.tree_map<type Int, Int>();
	if m.len() != 0 {
		return 1;
	}
	if not m.is_empty() {
		return 2;
	}
	m.insert(2, 20);
	m.insert(1, 10);
	m.insert(3, 30);
	val k1: Int = 1;
	if not m.contains_key(&k1) {
		return 3;
	}
	val v1: Int = match m.get_mut(&k1) {
		None => { -1 },
		Some(v) => { *v }
	};
	if v1 != 10 {
		return 4;
	}
	val old = m.insert(1, 99);
	val old_v: Int = match old {
		None => { -1 },
		Some(v) => { v }
	};
	if old_v != 10 {
		return 5;
	}
	if m.len() != 3 {
		return 6;
	}
	val rem: Int = match m.remove(&k1) {
		None => { -1 },
		Some(v) => { v }
	};
	if rem != 99 {
		return 7;
	}
	if m.contains_key(&k1) {
		return 8;
	}
	val k9: Int = 9;
	val miss: Int = match m.remove(&k9) {
		None => { 0 },
		Some(_v) => { 1 }
	};
	if miss != 0 {
		return 9;
	}
	m.clear();
	if m.len() != 0 {
		return 10;
	}
	if not m.is_empty() {
		return 11;
	}
	return 0;
}

fn main() nothrow -> Int {
	return try run() catch { 99 };
}
