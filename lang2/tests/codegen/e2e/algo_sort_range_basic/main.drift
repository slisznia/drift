module main

import std.iter as iter;

struct Range { data: Array<Int> }

implement iter.RandomAccessReadable<Int> for Range {
	pub fn len(self: &Range) nothrow -> Int { return self.data.len; }
	pub fn compare_at(self: &Range, i: Int, j: Int) nothrow -> Int {
		val a = self.data[i];
		val b = self.data[j];
		if a < b { return -1; }
		if a > b { return 1; }
		return 0;
	}
}

implement iter.RandomAccessPermutable<Int> for Range {
	pub fn swap(self: &mut Range, i: Int, j: Int) nothrow -> Void {
		val tmp = self.data[i];
		self.data[i] = self.data[j];
		self.data[j] = tmp;
	}
}

fn sort_in_place(r: &mut Range) nothrow -> Void {
	val n = iter.RandomAccessReadable::len(&*r);
	var i = 0;
	while i < n {
		var j = 0;
		while j + 1 < n - i {
			if iter.RandomAccessReadable::compare_at(&*r, j, j + 1) > 0 {
				iter.RandomAccessPermutable::swap(r, j, j + 1);
			}
			j = j + 1;
		}
		i = i + 1;
	}
	return;
}

fn main() nothrow -> Int {
	var r = Range(data = [3, 1, 2]);
	sort_in_place(&mut r);
	return r.data[0] * 100 + r.data[1] * 10 + r.data[2];
}
