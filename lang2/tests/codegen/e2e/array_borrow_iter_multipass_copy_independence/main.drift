module m_main

import std.iter as iter;

fn run() -> Int {
	val arr = [10, 20];
	var it0 = iter.Iterable::iter(&arr);
	var it1 = it0;
	val a = iter.SinglePassIterator::next(&mut it0);
	val b = iter.SinglePassIterator::next(&mut it1);
	var ax = -1;
	var bx = -1;
	val _ = match a{
		Some(v) => { ax = *v; 0 },
		None => { ax = -2; 0 },
	};
	val _ = match b{
		Some(v) => { bx = *v; 0 },
		None => { bx = -2; 0 },
	};
	if ax < 0 { return 1; }
	if bx < 0 { return 2; }
	if ax != 10 { return 3; }
	if bx != 10 { return 4; }
	return 0;
}

fn main() nothrow -> Int {
	val r = try run() catch { 1 };
	return r;
}
