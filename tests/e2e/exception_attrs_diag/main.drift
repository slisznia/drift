import std.console.out;

exception SqlErr(code: Int, msg: String)

fn raise_sql(code: Int) -> Void {
    val code_val = code
    throw SqlErr(code = code_val, msg = "bad")
}

fn main() -> Int {
  val forty_two: Int = 42
  try {
    raise_sql(forty_two)
  } catch e {
    val dv = e.attrs["code"]
    val opt = dv.as_int()
    val fallback: Int = -1
    return opt.unwrap_or(fallback)
  }
  return -1
}
